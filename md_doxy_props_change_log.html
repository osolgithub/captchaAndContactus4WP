<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Captcha and Contact Us Forms for Wordpress: Change Log</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Captcha and Contact Us Forms for Wordpress<span id="projectnumber">&#160;0.0.1</span>
   </div>
   <div id="projectbrief">Plugin to add captcha to core wordpress forms and additional option for contact us page.</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_doxy_props_change_log.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Change Log </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md1"></a>
Stable Tag 0.9</h1>
<h2><a class="anchor" id="autotoc_md2"></a>
08-10-2022</h2>
<ol type="1">
<li>corrected bug in MVC/ExtraClasses/OSOLMultiCaptcha.php by appropriately setting <code>$this-&gt;fontPNGLocation</code> <div class="fragment"><div class="line">$this-&gt;fontPNGLocation = realpath(dirname(__FILE__).$this-&gt;DS.&#39;..&#39;.$this-&gt;DS.&#39;..&#39;.$this-&gt;DS)</div>
</div><!-- fragment --></li>
<li>Fixed bug in MVC/Views/ContactusView.php adding a slash to stdClass <div class="fragment"><div class="line">$var2Display = new \stdClass();</div>
</div><!-- fragment --></li>
<li>in <a class="el" href="cust_captcha_contact_8php.html" title="Bootstrap file for this plugin.">custCaptchaContact.php</a> changed <div class="fragment"><div class="line">add_action( &#39;lostpassword_form&#39;, &#39;include_cust_captcha_lostpassword&#39; );</div>
<div class="line">add_action( &#39;lostpassword_post&#39;, &#39;include_cust_captcha_lostpassword_post&#39;, 10, 3 );</div>
</div><!-- fragment --> to <div class="fragment"><div class="line">add_action( &#39;lostpassword_form&#39;, [$OSOLCCC_Frontend_inst,&#39;include_cust_captcha_lostpassword&#39;] );</div>
<div class="line">add_action( &#39;lostpassword_post&#39;, [$OSOLCCC_Frontend_inst,&#39;include_cust_captcha_lostpassword_post&#39;], 10, 3 );</div>
</div><!-- fragment --></li>
<li>in MVC/Views/ContactusView.php added inside <code>function getCaptchaBlockHTML($forForm = "login")</code> <div class="fragment"><div class="line">$REQUEST_URI = filter_input(INPUT_SERVER, &#39;REQUEST_URI&#39;); </div>
<div class="line">//echo $REQUEST_URI . &quot; pos is &quot;. strpos( $REQUEST_URI, &#39;/wp-login.php&#39; ). &quot;&lt;br /&gt;&quot;;</div>
<div class="line">if( false !== strpos( $REQUEST_URI, &#39;/wp-login.php&#39; ) ) //in wp-login.php hooks ie &quot;add_action( &#39;admin_footer&#39;, &amp; add_action( &#39;wp_footer&#39;,&quot; down work since there is no  &lt;footer&gt;</div>
<div class="line">{ </div>
<div class="line">    $OSOLCCC_CommonClass_inst = \OSOLCCC\Hooks\Common::getInstance();</div>
<div class="line">    $OSOLCCC_CommonClass_inst-&gt;add_ajaxurl_cdata_to_front();</div>
<div class="line">    $OSOLCCC_CommonClass_inst-&gt;add_ccc_onload();</div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>in MVC/Hooks/Common.php changed <code>function refreshOSOLMultiCaptchaImage()</code> so ajax call for captcha image is made only when required </li>
</ol>
<h1><a class="anchor" id="autotoc_md3"></a>
Stable Tag 0.8</h1>
<h2><a class="anchor" id="autotoc_md4"></a>
Made more OOP</h2>
<h2><a class="anchor" id="autotoc_md5"></a>
24-06-2022</h2>
<p ><em>Objective:</em> seperate logic for plugin (further seperate front end and backend) &amp; wp hooks</p>
<ol type="1">
<li>created new folder <code>Helpers</code> for plugnin helper classes , name space will be <code>namespace OSOLCCCF\Helpers</code></li>
<li>used <code>spl_autoload_register</code> to <a href="https://www.php.net/manual/en/function.spl-autoload-register.php">autoload</a> <div class="fragment"><div class="line">// auto load Helpers/Frontend.php while calling new \OSOLCCC\Helpers\Frontend() </div>
<div class="line">if(!function_exists(&#39;version_compare&#39;) || version_compare(phpversion(), &#39;5.1.0&#39;, &#39;&lt;&#39;))die(&quot;Minimum version required for &#39;Customizable Captcha and contact us&#39; plugin is 5.1.0&quot;);</div>
<div class="line">spl_autoload_register(function ($class) {</div>
<div class="line">    // project-specific namespace prefix</div>
<div class="line">    $prefix = &#39;OSOLCCC\\Helpers\\&#39;; </div>
<div class="line">    // base directory for the namespace prefix</div>
<div class="line">    $base_dir = dirname(__FILE__).DIRECTORY_SEPARATOR.&#39;Helpers/&#39;;</div>
<div class="line">    //die($class . &quot; &quot; . str_replace($prefix,&#39;&#39;,$class));</div>
<div class="line">    // does the class use the namespace prefix?</div>
<div class="line">    $len = strlen($prefix);</div>
<div class="line">    if (strncmp($prefix, $class, $len) !== 0) {</div>
<div class="line">        // no, move to the next registered autoloader</div>
<div class="line">        return;</div>
<div class="line">    }   </div>
<div class="line">    // get the relative class name</div>
<div class="line">    $relative_class = substr($class, $len);</div>
<div class="line">    // replace the namespace prefix with the base directory, replace namespace</div>
<div class="line">    // separators with directory separators in the relative class name, append</div>
<div class="line">    // with .php</div>
<div class="line">    $mappedFile = $base_dir . str_replace(&#39;\\&#39;, &#39;/&#39;, $relative_class) . &#39;.php&#39;;</div>
<div class="line">    if (file_exists($mappedFile)) {</div>
<div class="line">        require $mappedFile;</div>
<div class="line">    }</div>
<div class="line">    else</div>
<div class="line">    {</div>
<div class="line">        die(&#39;&lt;p style=&quot;background:#f00&quot;&gt;ERROR!!!!! file : &#39;.$mappedFile. &quot; does not exist to autoload for &quot;.$class .&quot;&lt;/p&gt;&quot;);</div>
<div class="line">    }</div>
<div class="line">});</div>
</div><!-- fragment --></li>
</ol>
<ol type="1">
<li>created new <code>FrontEnd</code> , <code>Backend</code> and <code>Wphooks</code> classes in <code>Helpers</code> folder</li>
<li>declared the following in the beginning. <div class="fragment"><div class="line">require_once(dirname(__FILE__).DIRECTORY_SEPARATOR.&#39;pluginClasses/FrontEnd.php&#39;);</div>
<div class="line">require_once(dirname(__FILE__).DIRECTORY_SEPARATOR.&#39;pluginClasses/BackEnd.php&#39;);</div>
<div class="line">require_once(dirname(__FILE__).DIRECTORY_SEPARATOR.&#39;pluginClasses/WPHooks.php&#39;);</div>
<div class="line">$OSOL_CCC_HandlerFrontEnd_inst = new \OSOLCCCF\PluginHelpers\FrontEndMain();</div>
<div class="line">$OSOL_CCC_HandlerBackEnd_inst = new \OSOLCCCF\PluginHelpers\BackEndMain();</div>
<div class="line">$OSOL_CCC_HandlerWPHooks_inst = new \OSOLCCCF\PluginHelpers\WPHooks();</div>
</div><!-- fragment --></li>
<li>replaced all add_action('([^']+)',\s*'([^']+)' with add_action('\1',[$OSOL_CCC_HandlerFrontEnd_inst,'\2']</li>
<li>Main file <code><a class="el" href="cust_captcha_contact_8php.html" title="Bootstrap file for this plugin.">custCaptchaContact.php</a></code> only contains calls to wp hooks</li>
</ol>
<h1><a class="anchor" id="autotoc_md6"></a>
Stable Tag 0.7</h1>
<h2><a class="anchor" id="autotoc_md7"></a>
Made Captcha GDPR Compliant</h2>
<h2><a class="anchor" id="autotoc_md8"></a>
22-06-2022</h2>
<ol type="1">
<li>OSOLMultiCaptcha.php replaced with latest <a href="https://github.com/osolgithub/OSOLMulticaptcha">OSOLMultiCaptcha</a></li>
<li><p class="startli">captcha-customization-options.php</p><ol type="a">
<li></li>
</ol>
<p class="startli">&lt;label id="jform_params_caseInsensitive-lbl" for="jform_params_caseInsensitive" title=""&gt;GDPR Compliant(No Cookie):&lt;/label&gt;&lt;input type="checkbox" id="jform_params_gdprCompliantNoCookie" name="OSOLMulticaptcha_gdprCompliantNoCookie" value="1" &lt;?php echo get_option('OSOLMulticaptcha_gdprCompliantNoCookie') == 1?"checked=\"checked\"":'';?&gt;/&gt; </p><ol type="a">
<li></li>
</ol>
<p class="startli">&lt;?php $OSOLCaptchaEncryptionKey = get_option('OSOLCaptchaEncryptionKey') != ''?get_option('OSOLCaptchaEncryptionKey'):"YourUniqueEncryptionKey";?&gt; &lt;label id="jform_params_bgColor-lbl" for="jform_params_bgColor" title=""&gt;Encryption Key&lt;/label&gt; &lt;input name="OSOLCaptchaEncryptionKey" id="jform_params_bgColor" value="&lt;?php echo $OSOLCaptchaEncryptionKey;?&gt;" size="25" type="text" &gt; </p>
</li>
<li><p class="startli">displayCaptcha.php:</p><ol type="a">
<li>added following blocks to prevent setting $_SESSION</li>
</ol>
<div class="fragment"><div class="line">$OSOLMulticaptcha_gdprCompliantNoCookie = get_option(&#39;OSOLMulticaptcha_gdprCompliantNoCookie&#39;);</div>
<div class="line">if(!$OSOLMulticaptcha_gdprCompliantNoCookie)</div>
<div class="line">{</div>
</div><!-- fragment --><p class="startli">and following block to show json object instead of image</p>
<div class="fragment"><div class="line">if(!$OSOLMulticaptcha_gdprCompliantNoCookie)</div>
<div class="line">{</div>
<div class="line">    $captchaEncryptionKey = get_option(&#39;OSOLCaptchaEncryptionKey&#39;);// IMPORTANT ****** YOU MUST SET A CUSTOM VALUE FOR YOUR SITE from admin panel</div>
<div class="line">    $captcha-&gt;setCaptchaEncryptionKey($captchaEncryptionKey);</div>
<div class="line">    $returnImgObj = true;</div>
<div class="line">    $captchaImgObj = $captcha-&gt;displayCaptcha($returnImgObj);</div>
<div class="line">    ob_start();</div>
<div class="line">    imagepng($captchaImgObj);</div>
<div class="line">    $imageContent = ob_get_contents();</div>
<div class="line">    ob_end_clean(); </div>
<div class="line">    </div>
<div class="line">    $var2Display = new stdClass();</div>
<div class="line">    $var2Display-&gt;captchaEncypted = $captcha-&gt;getEncryptedCaptchaString();</div>
<div class="line">    $var2Display-&gt;imageContent = base64_encode($imageContent);</div>
<div class="line">    die(json_encode($var2Display));</div>
<div class="line">    </div>
<div class="line">}</div>
<div class="line">else</div>
<div class="line">{</div>
</div><!-- fragment --></li>
<li><p class="startli"><a class="el" href="cust_captcha_contact_8php.html" title="Bootstrap file for this plugin.">custCaptchaContact.php</a> added</p><ol type="a">
<li>added <div class="fragment"><div class="line">if(!isset($_REQUEST[&#39;OSOLMulticaptcha_gdprCompliantNoCookie&#39;]))</div>
<div class="line">{</div>
<div class="line">    update_option(&#39;OSOLMulticaptcha_gdprCompliantNoCookie&#39;,0);</div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>added <code>&lt;input type="hidden" name="OSOLmulticaptcha_captchaEncypted" id="OSOLmulticaptcha_captchaEncypted" value="" &gt;</code> near each &lsquo;&lt;input id="OSOLmulticaptcha_keystring" name="OSOLmulticaptcha_keystring" size="15" type="text" &gt;&rsquo;</li>
<li><div class="fragment"><div class="line">$GLOBALS[&#39;OSOLMulticaptcha_gdprCompliantNoCookie&#39;] = get_option(&#39;OSOLMulticaptcha_gdprCompliantNoCookie&#39;);</div>
</div><!-- fragment --></li>
</ol>
<p class="startli">so that the following way it can be checked if captcha is without cookie</p>
<div class="fragment"><div class="line">if($GLOBALS[&#39;OSOLMulticaptcha_gdprCompliantNoCookie&#39;]) </div>
</div><!-- fragment --><ol type="a">
<li>Added new <code>function refreshOSOLMultiCaptchaImage()</code> to show captcha based on json data</li>
<li>Added &lsquo;add_action( 'wp_footer&rsquo;, 'add_ccc_onload' );<code>to call refreshOSOLMultiCaptchaImage() on window.onload.</code></li>
<li><code>Inside</code>include_cust_captcha_login()<code>added</code>add_ccc_onload();<code>since there is no &lt;footer&gt;</code></li>
</ol>
<ol type="a">
<li><code>inside</code>function cust_captcha_contact_validate_and_mail()`. added code to verify encrypted captcha</li>
</ol>
</li>
</ol>
<ol type="1">
<li>cccontact_form.php added<ol type="a">
<li><code>&lt;input type="hidden" name="OSOLmulticaptcha_captchaEncypted" id="OSOLmulticaptcha_captchaEncypted" value="" &gt;</code> near &lsquo;&lt;input id="OSOLmulticaptcha_keystring" name="OSOLmulticaptcha_keystring" size="15" type="text" &gt;&rsquo;</li>
</ol>
</li>
<li><a class="el" href="cccontact_8js.html" title="this file in jsfiles">cccontact.js</a> added<ol type="a">
<li>&lsquo;cccontact_post_data[jQuery("#OSOLmulticaptcha_captchaEncypted").attr('name&rsquo;)] = jQuery(jQuery("#OSOLmulticaptcha_captchaEncypted")).val();` </li>
</ol>
</li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
